---
output:
  html_document: default
  '': default
---
```{r include = FALSE}
library(tidyverse)
library(ggplot2)
library(stringr)

url<-"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destfile<-paste(getwd(),"exdata_data_NEI_data.zip",sep="/") 
download.file(url, destfile)
unzip(destfile)
data<-read.csv("activity.csv")

```
What is the mean number of steps taken per day?


This code creates a histogram plot of the total number of steps taken each day:
  
```{r message = FALSE, warning = FALSE}
sum<-data %>% group_by(date) %>% summarise(dailysteps = sum(steps))
ggplot(sum, aes(dailysteps)) + geom_histogram()
```


The code below provides the mean and median of steps each day


```{r message = FALSE, warning = FALSE}

mean<-mean(sum$dailysteps, na.rm = TRUE)
median<-median(sum$dailysteps,na.rm=TRUE)
```
                
The mean number of steps is `r mean` and the median is `r median`


What is the average daily activity pattern?

```{r warning = FALSE, message = FALSE}
average_steps<-data %>% group_by(interval) %>% summarise(average_steps = mean(steps, na.rm = TRUE))

ggplot(average_steps, aes(interval, average_steps)) + geom_line()
```


Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
average_steps %>% summarise(max = max(average_steps))

max_interval<-average_steps[which.max(average_steps$average_steps),1]

```
The interval with the maximum number of steps is `r max_interval`

Imputing missing values: 
1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
```{r}
missing_rows<-nrow(data %>% filter(is.na(steps)))
```
The number of rows with missing data is `r missing_rows`
data

```{r}
imput_function <- function(i, data) {
if(is.na(data[i,1])) {
data[i,1]<-average_steps[data[i,3], 2]
  } else {
  data[i,1]
  }
  data[i,]
} 
```
